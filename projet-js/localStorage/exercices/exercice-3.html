<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark">
    <link rel="stylesheet" href="css/pico.min.css">
    <title>Exercice 3</title>
  </head>
  <body>
    <main class="container">

      <!--
        üìã EXERCICE 3 : Todo List persistante
        
        OBJECTIF : Travailler avec des tableaux et objets complexes
        
        CONCEPTS UTILES :
        - Tableaux d'objets : structure complexe de donn√©es
        - JSON.stringify() : convertir un objet en cha√Æne
        - JSON.parse() : convertir une cha√Æne en objet
        - forEach() : parcourir un tableau
        - findIndex() : trouver l'index d'un √©l√©ment
        - splice() : supprimer des √©l√©ments d'un tableau
        - createElement() : cr√©er des √©l√©ments HTML dynamiquement
        
        BONNES PRATIQUES :
        - Toujours v√©rifier si les donn√©es existent avant de les utiliser
        - Utiliser des IDs uniques pour identifier les √©l√©ments
        - Rafra√Æchir l'affichage apr√®s chaque modification
        - G√©rer l'√©tat vide (aucune t√¢che)
        - Commenter chaque √©tape du code
      -->

      <h1>Exercice 3</h1>

      <!-- TODO: Cr√©er l'interface pour ajouter des t√¢ches -->
      <!-- - Champ texte pour saisir une t√¢che -->
      <!-- - Bouton "Ajouter" -->
      <!-- - Zone pour afficher la liste des t√¢ches -->
       <input class="text" type="text" placeholder="Saisir une t√¢che">
       <button class="addBtn" type="button">Ajouter</button>
       <ul class="taskList"></ul>

    </main>

    <script>
      // TODO: √âTAPE 1 - S√âLECTIONNER LES √âL√âMENTS
      // Utiliser querySelector pour r√©cup√©rer :
      // - Le champ texte pour saisir une t√¢che
      // - Le bouton "Ajouter"
      // - La zone d'affichage des t√¢ches

      let textInput = document.querySelector(".text");
      const addBtn = document.querySelector(".addBtn");
      let list = document.querySelector(".taskList");

      // TODO: √âTAPE 2 - INITIALISER LES DONN√âES
      // - R√©cup√©rer les t√¢ches depuis localStorage
      // - Utiliser JSON.parse() pour convertir en tableau
      // - G√©rer le cas o√π aucune donn√©e n'existe (tableau vide)
      // - Exemple : const tasks = JSON.parse(localStorage.getItem("tasks")) || [];

      const tasks = JSON.parse(localStorage.getItem("tasks")) || [];

      // TODO: √âTAPE 3 - FONCTION D'AFFICHAGE
      // Cr√©er une fonction renderTasks() qui :
      // - Vide la zone d'affichage
      // - Parcourt le tableau des t√¢ches avec forEach()
      // - Cr√©e un √©l√©ment HTML pour chaque t√¢che
      // - Affiche le texte, le statut et la date

      function renderTasks() {
        list.innerHTML = "";
        textInput.value = "";
        tasks.forEach((task, index) => {
          const li = document.createElement("li");
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.checked = task.completed;
          
          checkbox.addEventListener("change", () => {
          tasks[index].completed = checkbox.checked;
          localStorage.setItem("tasks", JSON.stringify(tasks));
          renderTasks();
          });
          const span = document.createElement("span");
    span.textContent = task.text;

    const deleteBtn = document.createElement("button");
    deleteBtn.textContent = "Supprimer";

    deleteBtn.addEventListener("click", () => {
    tasks.splice(index, 1);
    localStorage.setItem("tasks", JSON.stringify(tasks));
    renderTasks();
    })

          li.appendChild(checkbox);
          li.appendChild(span);
          list.appendChild(li);
          li.appendChild(deleteBtn);
        });
      }

      // TODO: √âTAPE 4 - AJOUTER UNE T√ÇCHE
      // - Ajouter un event listener sur le bouton "Ajouter"
      // - R√©cup√©rer le texte saisi
      // - Cr√©er un nouvel objet t√¢che avec :
      //   * id: new Date().getTime() (timestamp unique)
      //   * text: le texte saisi
      //   * completed: false (par d√©faut)
      //   * date: new Date().toISOString()
      // - Ajouter au tableau avec push()
      // - Sauvegarder avec JSON.stringify()
      // - Appeler renderTasks() pour rafra√Æchir

      addBtn.addEventListener("click", () => {
        const textWritten = textInput.value;
        console.log("Texte saisi:", textWritten); 
          if(textWritten.trim() === "") {
          return;}
        const newTask = {
          id: new Date().getTime(),
          text: textWritten,
          completed: false,
          date: new Date().toISOString()
        };

        tasks.push(newTask);
        localStorage.setItem("tasks", JSON.stringify(tasks))
        renderTasks();
      });

      renderTasks();

      // TODO: √âTAPE 5 - MODIFIER LE STATUT
      // Pour chaque t√¢che affich√©e :
      // - Cr√©er une checkbox
      // - Ajouter un event listener "change"
      // - Modifier task.completed = checkbox.checked
      // - Sauvegarder et rafra√Æchir


      // TODO: √âTAPE 6 - SUPPRIMER UNE T√ÇCHE
      // Pour chaque t√¢che affich√©e :
      // - Cr√©er un bouton "Supprimer"
      // - Ajouter un event listener "click"
      // - Utiliser findIndex() pour trouver l'index
      // - Utiliser splice(index, 1) pour supprimer
      // - Sauvegarder et rafra√Æchir

      // TODO: √âTAPE 7 - INITIALISATION
      // - Appeler renderTasks() au chargement de la page
      // - Utiliser DOMContentLoaded pour s'assurer que le DOM est pr√™t

    </script>
  </body>
</html>